[phases.setup]
nixPkgs = ["nodejs_18"]

[phases.install]
cmds = [
  "if [ -d frontend ]; then npm --prefix frontend install; elif [ -d ../frontend ]; then npm --prefix ../frontend install; else echo 'No frontend directory found, skipping frontend install'; fi",
  "if [ -d backend ]; then npm --prefix backend install; else npm install; fi"
]

[phases.build]
cmds = [
  "if [ -d frontend ]; then npm --prefix frontend run build; elif [ -d ../frontend ]; then npm --prefix ../frontend run build; else echo 'No frontend directory found, skipping frontend build'; fi"
]

[start]
cmd = "if [ -d backend ]; then cd backend && npm start; else npm start; fi"
